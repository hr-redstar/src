# プライベートVC 仕様 (Professional Edition)

## 概要
配車がマッチングした際に自動作成される、送迎者・利用者・相乗り者間のコミュニケーションおよび進行管理用チャンネルです。

## 1. チャンネル命名規則
**書式**: `MM/DD HH:mm~--:-- 【方面】→【方角】`
- **MM/DD**: マッチング日付
- **HH:mm**: マッチング時刻
- **--:--**: 終了時までプレースホルダ。終了時に実際の時刻へ置換。
- **方面**: 利用者のピックアップ地点（旧：目印）
- **方角**: 送迎の目的地

## 2. 管理Embedの同期 (重要)
以下の3箇所に投稿されるEmbedは、`dispatchProgressUpdater.js` を通じて**完全にリアルタイム同期**されます。
1. **VC内コントロールパネル** (操作の起点)
2. **運営者ログ** (1送迎につき1メッセージを維持し、editで更新)
3. **利用者メモ** (個人の履歴として残るメッセージ)

### ステータス構成
- **マッチング (MATCHED)**: 🟡 黄色
- **向かっています (HEADING)**: 🟣 紫色
- **送迎開始 (STARTED)**: 🔵 青色
- **送迎終了 (COMPLETED)**: ✅ 終了時は黒（または緑）、ステータスを「完了」へ変更

## 3. 送迎業務フロー
VC内のボタン操作に連動して以下の処理が走ります。

- **🚗 向かっています**: タイムスタンプを記録し、Embedの進行状況を更新。
- **🚀 送迎開始**: 送迎者・利用者の双方の開始を記録（プロフェッショナル表示）。
- **✅ 送迎終了**: 
  - 運行データの履歴化とファイルの削除。
  - 送迎者へ「待機列に戻る」ボタン付きのDMを送信。
  - 利用者へ「評価依頼」DMを送信。

## 4. 相乗り対応
- 相乗りが承認されるたびに、ルート（方面）および進行状況管理Embedの「相乗り者」フィールドが動的に追加・更新されます。
- VCタイトルも新しいルートに合わせて動的にリネームされます。