# カスタムID 仕様書（v2）

Custom ID は、ボットのインタラクション（ボタン、セレクトメニュー、モーダル）を識別するための識別子です。

## 構成
`<namespace>|<action>|<params>`

- **namespace**: 機能カテゴリ（例: `ps`, `ride`, `reg`, `adm`）
- **action**: 動作（例: `send`, `select`, `start`, `end`）
- **params**: パラメータ（`key=value` 形式、`&` で連結）

## 命名・運用ルール
- **action**: 動詞・現在形で定義する（send / select / start / cancel 等）。snake_case は避ける。
- **params**: 予約キー: `panel` (パネル種別), `vc` (VC ID), `uid` (User ID), `mid` (Message ID)。
- **無効なID**: 仕様に合致しないIDはエラーを投げず、単に無視する（parserがnullを返す）。

## バージョニング・ポリシー (Versioning Policy)

- **v1 (Legacy)**: `:` 区切り（例: `ps:send:admin`）
- **v2 (Current)**: `|` 区切り（例: `ps|send|panel=admin`）
- `handler.js` の `parseCustomId` のみが Custom ID の構造を直接解釈する。

## 開発ルール
- **直接 split 禁止**: 各機能ハンドラー内で `interaction.customId.split(':')` や `split('|')` を直接行ってはならない。必ず `parsed.namespace`, `parsed.action`, `parsed.params` を使用すること。
- **後方互換性**: 移行期間中は `parseCustomId` が v1/v2 両方を解釈し、共通の `parsed` オブジェクトを返却する。

## 実例
- **パネル設置ボタン**: `ps|send|panel=rideList`
- **チャンネル選択メンバ**: `ps|select|panel=rideList`
- **送迎開始操作**: `ride|start|vc=1234567890`
