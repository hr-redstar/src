# 送迎者Bot – リリースノート

> [!IMPORTANT]
> **最終更新日**: 2026-01-17  
> **PDF出力・印刷時の注意**: 本リリースノート内の図解やリンクが崩れる場合は、同梱の [運用マニュアル v2.0.0](./OPERATIONS_MANUAL_v2.0.0.md) を参照してください。

📌 **概要**  
Discord 上で送迎・配車管理を自動化する Bot です。  
第3～第9フェーズの完了により、高精度な設計、自動テスト、統計・評価管理、および高度な運用基盤が完成しました。

## 📝 バージョン履歴 (Version History)

| Version | Date | 主な更新内容 | 開発フェーズ |
| :---: | :--- | :--- | :--- |
| **v2.3.0** | 2026-01-21 | **Optimization & Maintenance** <br>・未使用レガシーファイルの完全削除。<br>・起動時設定整合性チェック（Config Integrity Guard）の導入。<br>・詳細なリリースノートの整備。 | Maintenance |
| **v2.2.0** | 2026-01-21 | **Core Stability Audit: Final Integration** <br>・`状態確認.js` のクラッシュ不具合修正。<br>・レガシーな `interactionTemplate` の完全排除。 | Maintenance |
| **v2.1.1** | 2026-01-20 | **Panel Setup Audit & Standardization** <br>・パネル設置アクションのインポート漏れ（`MessageFlags`等）を一斉修正。<br>・`CUSTOM_ID` 定数化による不整合防止。 | Maintenance |
| **v2.0.0** | 2026-01-19 | **Professional Edition Release** <br>・**1-Ride-1-Embed**: 運行ログのリアルタイム追跡システム完成。<br>・**Professional History**: 過去の全走行データと統計を検索・分析可能な管理者ツール。<br>・**Full Documentation**: 運用マニュアルとREADMEの完全更新。<br>・**Quality Assurance**: 全面的なコードクリーンアップとテスト通過。 | Release |
| **v1.6.1** | 2026-01-18 | **Reliability Hotfix: Interaction Acknowledgment** <br>・`deferReply` による3秒ルールの完全回避。<br>・`deferUpdate` 排除による ACK 不整合の抜本的修正。<br>・各管理ハンドラのルーティング安定化。 | Maintenance |
| **v1.6.0** | 2026-01-18 | **Professional Operational UX Refresh** <br>・すべての運用・管理パネル（案内、VC制御、出退勤、強制終了等）を `buildPanelEmbed` 規格へ統一。<br>・プレミアムデザインと動的カラーリングの導入。 | Phase 9+++ |
| **v1.5.0** | 2026-01-18 | **Professional Rating & Ranking System** <br>・評価依頼DMのUI刷新（プレミアムデザイン統合）。<br>・運営者向け「口コミランクパネル」新設（統計・ランキング・履歴閲覧）。<br>・ランク階級システム導入（ダイヤモンド・プラチナ等の自由設定と個別付与）。<br>・登録台帳への評価点（⭐平均点・件数）の統合。 | Phase 9++ |
| **v1.4.0** | 2026-01-18 | **管理システム・セキュリティ全面刷新** <br>・スレッド型登録台帳（大規模運用対応）。<br>・運営者ログ（1送迎＝1Embed更新型）。<br>・運営者ロールによるアクセス制御とチャンネル自動秘匿化。 | Phase 9+ |
| **v1.3.1** | 2026-01-17 | **最終最適化・運営者ログ機能強化** <br>・運営者ログのリアルタイムEmbed化（マッチング・相乗り・延長状況の可視化）。<br>・起動プロセスの非同期化によるパフォーマンス向上。<br>・ルーティングロジックのモジュール化による保守性向上。 | Phase 9+ |
| v1.3.0 | 2026-01-17 | **管理者パネル改善・バグ修正・マニュアル整備** <br>・管理者パネルUI整理（履歴・統計をサブパネル化）。<br>・グローバルログスレッド対応。<br>・案内パネルの設置対応。<br>・**ルーティングの重大な修正**: `ps|select` 形式のルーティング不整合を解消。 | Phase 9 |
| v1.2.0 | 2026-01-20 | **評価・ランク・詳細履歴機能の完成** <br>・プロフィール Embed にランク・平均評価表示。<br>・管理者パネルで日別・送迎履歴閲覧機能追加。 | Phase 8 |
| **v1.1.0** | 2026-01-17 | **相乗りシステム強化 & ユーザーポリシー統合** <br>・相乗り方面選択フロー、ルート区間挿入ロジック、スレッディングポリシー実装。 | Phase 7 |
| v0.9.0 | 2026-01-10 | **信頼性・観測性の向上。** <br>・TTLキャッシュ、GCS再試行ロジックの導入<br>・Human/Audit 2系統ログ、重大エラーの自動アラート基盤 | Phase 4-5 |
| v0.5.0 | 2026-01-05 | **基盤設計の刷新。** <br>・Custom ID解析の統一、ストレージ層の完全抽象化<br>・Jestによる単体テスト導入、GitHub Actions CI同期 | Phase 3 |

---

## ⚡ システム構造図
![システム構造フロー図](./assets/system_flow.png)
*図: システム全体のデータ・処理構造*

---

## 🛠️ 運用・操作のポイント
詳細な操作ガイドは [統合運用マニュアル v2.0.0](./OPERATIONS_MANUAL_v2.0.0.md) に集約されています。現場ではマニュアルを優先して参照してください。

### 1. 管理者・運営者
- **パネル管理**: `/管理者パネル` で統計・評価・詳細履歴を一元管理。
- **設置**: `/パネル設置パネル` で必要な機能を各チャンネルへ即座に展開。

### 2. 送迎者・利用者
- **配車依頼**: `/依頼` または案内パネルから開始。
- **出勤**: 「今から行けます」ボタンで待機列に参加。
- **相乗り**: 稼働中の車両があれば「相乗りする」ボタンが自動出現。

---

## 📖 関連ドキュメント
- [📖 v2.0.0 統合運用マニュアル](./OPERATIONS_MANUAL_v2.0.0.md)
- [📜 リポジトリ README](../../readme.md)
- [✅ フェーズ 9 検証記録 (walkthrough)](file:///c:/Users/User/.gemini/antigravity/brain/4b410c02-14bd-41db-97d0-b89047dcf235/walkthrough_v9.md)
